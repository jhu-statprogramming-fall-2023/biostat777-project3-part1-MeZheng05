<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="corrplot">
<title>An Introduction to corrplot Package • corrplot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to corrplot Package">
<meta property="og:description" content="corrplot">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">corrplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.93</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/corrplot-intro.html">An Introduction to corrplot Package</a>
    <a class="dropdown-item" href="../articles/Example_analysis.html">Example_analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/An%20Introduction%20to%20corrplot%20Package.html">
    <span class="fa fa-question-circle-o"></span>
     
    Introduction
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/taiyun/corrplot">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>An Introduction to corrplot Package</h1>
                        <h4 data-toc-skip class="author">Taiyun Wei,
Viliam Simko</h4>
            
            <h4 data-toc-skip class="date">2023-12-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/taiyun/corrplot/blob/HEAD/vignettes/corrplot-intro.Rmd" class="external-link"><code>vignettes/corrplot-intro.Rmd</code></a></small>
      <div class="d-none name"><code>corrplot-intro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>R package <strong>corrplot</strong> provides a visual exploratory
tool on correlation matrix that supports automatic variable reordering
to help detect hidden patterns among variables.</p>
<p>corrplot is very easy to use and provides a rich array of plotting
options in visualization method, graphic layout, color, legend, text
labels, etc. It also provides p-values and confidence intervals to help
users determine the statistical significance of the correlations.</p>
<p><code><a href="../reference/corrplot.html">corrplot()</a></code> has about 50 parameters, however the mostly
common ones are only a few. We can get a correlation matrix plot with
only one line of code in most scenes.</p>
<p>The mostly using parameters include <code>method</code>,
<code>type</code>, <code>order</code>, <code>diag</code>, and etc.</p>
<p>There are seven visualization methods (parameter <code>method</code>)
in corrplot package, named <code>'circle'</code>, <code>'square'</code>,
<code>'ellipse'</code>, <code>'number'</code>, <code>'shade'</code>,
<code>'color'</code>, <code>'pie'</code>. Color intensity of the glyph
is proportional to the correlation coefficients by default color
setting.</p>
<ul>
<li><p><code>'circle'</code> and <code>'square'</code>, the
<strong>areas</strong> of circles or squares show the absolute value of
corresponding correlation coefficients.</p></li>
<li><p><code>'ellipse'</code>, the ellipses have their eccentricity
parametrically scaled to the correlation value. It comes from D.J.
Murdoch and E.D. Chow’s job, see in section References.</p></li>
<li><p><code>'number'</code>, coefficients numbers with different
color.</p></li>
<li><p><code>'color'</code>, square of equal size with different
color.</p></li>
<li><p><code>'shade'</code>, similar to <code>'color'</code>, but the
negative coefficients glyphs are shaded. Method <code>'pie'</code> and
<code>'shade'</code> come from Michael Friendly’s job.</p></li>
<li><p><code>'pie'</code>, the circles are filled clockwise for positive
values, anti-clockwise for negative values.</p></li>
</ul>
<p><code><a href="../reference/corrplot.mixed.html">corrplot.mixed()</a></code> is a wrapped function for mixed
visualization style, which can set the visual methods of lower and upper
triangular separately.</p>
<p>There are three layout types (parameter <code>type</code>):
<code>'full'</code>, <code>'upper'</code> and <code>'lower'</code>.</p>
<p>The correlation matrix can be reordered according to the correlation
matrix coefficients. This is important to identify the hidden structure
and pattern in the matrix.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot" class="external-link">corrplot</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## corrplot 0.92 loaded</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, method <span class="op">=</span> <span class="st">'number'</span><span class="op">)</span> <span class="co"># colorful number</span></span></code></pre></div>
<p><img src="webimg/intro-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, method <span class="op">=</span> <span class="st">'color'</span>, order <span class="op">=</span> <span class="st">'alphabet'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/intro-2.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="co"># by default, method = 'circle'</span></span></code></pre></div>
<p><img src="webimg/intro-3.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, order <span class="op">=</span> <span class="st">'AOE'</span><span class="op">)</span> <span class="co"># after 'AOE' reorder</span></span></code></pre></div>
<p><img src="webimg/intro-4.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, method <span class="op">=</span> <span class="st">'shade'</span>, order <span class="op">=</span> <span class="st">'AOE'</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/intro-5.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, method <span class="op">=</span> <span class="st">'square'</span>, order <span class="op">=</span> <span class="st">'FPC'</span>, type <span class="op">=</span> <span class="st">'lower'</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/intro-6.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, method <span class="op">=</span> <span class="st">'ellipse'</span>, order <span class="op">=</span> <span class="st">'AOE'</span>, type <span class="op">=</span> <span class="st">'upper'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/intro-7.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.mixed.html">corrplot.mixed</a></span><span class="op">(</span><span class="va">M</span>, order <span class="op">=</span> <span class="st">'AOE'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/intro-8.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.mixed.html">corrplot.mixed</a></span><span class="op">(</span><span class="va">M</span>, lower <span class="op">=</span> <span class="st">'shade'</span>, upper <span class="op">=</span> <span class="st">'pie'</span>, order <span class="op">=</span> <span class="st">'hclust'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/intro-9.png" width="600px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="reorder-a-correlation-matrix">Reorder a correlation matrix<a class="anchor" aria-label="anchor" href="#reorder-a-correlation-matrix"></a>
</h2>
<p>The details of four <code>order</code> algorithms, named
<code>'AOE'</code>, <code>'FPC'</code>, <code>'hclust'</code>,
<code>'alphabet'</code> are as following.</p>
<ul>
<li>
<p><code>'AOE'</code> is for the angular order of the eigenvectors.
It is calculated from the order of the angles <span class="math inline">\(a_i\)</span>,</p>
<p><span class="math display">\[
a_i =
\begin{cases}
            \arctan (e_{i2}/e_{i1}), &amp; \text{if $e_{i1}&gt;0$;}
             \newline
            \arctan (e_{i2}/e_{i1}) + \pi, &amp; \text{otherwise.}
\end{cases}         
\]</span></p>
<p>where <span class="math inline">\(e_1\)</span> and <span class="math inline">\(e_2\)</span> are the largest two eigenvalues of
the correlation matrix. See <a href="http://www.datavis.ca/papers/corrgram.pdf" class="external-link">Michael Friendly
(2002)</a> for details.</p>
</li>
<li><p><code>'FPC'</code> for the first principal component
order.</p></li>
<li><p><code>'hclust'</code> for hierarchical clustering order, and
<code>'hclust.method'</code> for the agglomeration method to be used.
<code>'hclust.method'</code> should be one of <code>'ward'</code>,
<code>'ward.D'</code>, <code>'ward.D2'</code>, <code>'single'</code>,
<code>'complete'</code>, <code>'average'</code>,
<code>'mcquitty'</code>, <code>'median'</code> or
<code>'centroid'</code>.</p></li>
<li><p><code>'alphabet'</code> for alphabetical order.</p></li>
</ul>
<p>You can also reorder the matrix ‘manually’ via function
<code><a href="../reference/corrMatOrder.html">corrMatOrder()</a></code>.</p>
<p>If using <code>'hclust'</code>, <code><a href="../reference/corrplot.html">corrplot()</a></code> can draw
rectangles around the plot of correlation matrix based on the results of
hierarchical clustering.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, order <span class="op">=</span> <span class="st">'hclust'</span>, addrect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/hclust-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, method <span class="op">=</span> <span class="st">'square'</span>, diag <span class="op">=</span> <span class="cn">FALSE</span>, order <span class="op">=</span> <span class="st">'hclust'</span>,</span>
<span>         addrect <span class="op">=</span> <span class="fl">3</span>, rect.col <span class="op">=</span> <span class="st">'blue'</span>, rect.lwd <span class="op">=</span> <span class="fl">3</span>, tl.pos <span class="op">=</span> <span class="st">'d'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/hclust-2.png" width="600px" style="display: block; margin: auto;"></p>
<p>R package <strong>seriation</strong> provides the infrastructure for
ordering objects with an implementation of several
seriation/sequencing/ordination techniques to reorder matrices,
dissimilarity matrices, and dendrograms. For more information, see in
section References.</p>
<p>We can reorder the matrix via <strong>seriation</strong> package and
then corrplot it. Here are some examples.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mhahsler/seriation" class="external-link">seriation</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'seriation' was built under R version 4.3.2</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/seriation/man/registry_for_seriaiton_methods.html" class="external-link">list_seriation_methods</a></span><span class="op">(</span><span class="st">'matrix'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "AOE"       "BEA"       "BEA_TSP"   "CA"        "Heatmap"   "Identity" </span></span>
<span><span class="co">##  [7] "LLE"       "Mean"      "PCA"       "PCA_angle" "Random"    "Reverse"</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/seriation/man/registry_for_seriaiton_methods.html" class="external-link">list_seriation_methods</a></span><span class="op">(</span><span class="st">'dist'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "ARSA"           "BBURCG"         "BBWRCG"         "Enumerate"     </span></span>
<span><span class="co">##  [5] "GSA"            "GW"             "GW_average"     "GW_complete"   </span></span>
<span><span class="co">##  [9] "GW_single"      "GW_ward"        "HC"             "HC_average"    </span></span>
<span><span class="co">## [13] "HC_complete"    "HC_single"      "HC_ward"        "Identity"      </span></span>
<span><span class="co">## [17] "isomap"         "isoMDS"         "MDS"            "MDS_angle"     </span></span>
<span><span class="co">## [21] "metaMDS"        "monoMDS"        "OLO"            "OLO_average"   </span></span>
<span><span class="co">## [25] "OLO_complete"   "OLO_single"     "OLO_ward"       "QAP_2SUM"      </span></span>
<span><span class="co">## [29] "QAP_BAR"        "QAP_Inertia"    "QAP_LS"         "R2E"           </span></span>
<span><span class="co">## [33] "Random"         "Reverse"        "Sammon_mapping" "SGD"           </span></span>
<span><span class="co">## [37] "Spectral"       "Spectral_norm"  "SPIN_NH"        "SPIN_STS"      </span></span>
<span><span class="co">## [41] "TSP"            "VAT"</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Zoo</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Zoo</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">17</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist2order</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">corr</span>, <span class="va">method</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d_corr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">corr</span><span class="op">)</span></span>
<span>  <span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/seriation/man/seriate.html" class="external-link">seriate</a></span><span class="op">(</span><span class="va">d_corr</span>, method <span class="op">=</span> <span class="va">method</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">i</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/seriation/man/get_order.html" class="external-link">get_order</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Methods <code>'PCA_angle'</code> and <code>'HC'</code> in
<strong>seriation</strong>, are same as <code>'AOE'</code> and
<code>'hclust'</code> separately in <code><a href="../reference/corrplot.html">corrplot()</a></code> and
<code><a href="../reference/corrMatOrder.html">corrMatOrder()</a></code>.</p>
<p>Here are some plots after seriation.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fast Optimal Leaf Ordering for Hierarchical Clustering</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fu">dist2order</span><span class="op">(</span><span class="va">Z</span>, <span class="st">'OLO'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span><span class="op">]</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/seriation-plot-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quadratic Assignment Problem</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fu">dist2order</span><span class="op">(</span><span class="va">Z</span>, <span class="st">'QAP_2SUM'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span><span class="op">]</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/seriation-plot-2.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multidimensional Scaling</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fu">dist2order</span><span class="op">(</span><span class="va">Z</span>, <span class="st">'MDS_nonmetric'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in get_seriation_method("dist", method): seriation method</span></span>
<span><span class="co">## 'MDS_nonmetric' is now deprecated and will be removed in future releases. Using</span></span>
<span><span class="co">## `isoMDS`</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span><span class="op">]</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/seriation-plot-3.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated annealing</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fu">dist2order</span><span class="op">(</span><span class="va">Z</span>, <span class="st">'ARSA'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span><span class="op">]</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/seriation-plot-4.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TSP solver</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fu">dist2order</span><span class="op">(</span><span class="va">Z</span>, <span class="st">'TSP'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span><span class="op">]</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/seriation-plot-5.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Spectral seriation</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fu">dist2order</span><span class="op">(</span><span class="va">Z</span>, <span class="st">'Spectral'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span><span class="op">]</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/seriation-plot-6.png" width="600px" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/corrRect.html">corrRect()</a></code> can add rectangles on the plot with three
ways(parameter <code>index</code>, <code>name</code> and
<code>namesMat</code>) after <code><a href="../reference/corrplot.html">corrplot()</a></code>. We can use pipe
operator <code>*&gt;%</code> in package <code>magrittr</code> with more
convenience. Since R 4.1.0, <code>|&gt;</code> is supported without
extra package.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rank-two ellipse seriation, use index parameter</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fu">dist2order</span><span class="op">(</span><span class="va">Z</span>, <span class="st">'R2E'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="va">i</span>, <span class="va">i</span><span class="op">]</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/corrRect.html">corrRect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/rectangles-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use name parameter</span></span>
<span><span class="co"># Since R 4.1.0, the following one line code works:</span></span>
<span><span class="co"># corrplot(M, order = 'AOE') |&gt; corrRect(name = c('gear', 'wt', 'carb'))</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span>, order <span class="op">=</span> <span class="st">'AOE'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/corrRect.html">corrRect</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'tail'</span>, <span class="st">'airborne'</span>, <span class="st">'venomous'</span>, <span class="st">'predator'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/rectangles-2.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use namesMat parameter</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'eggs'</span>, <span class="st">'catsize'</span>, <span class="st">'airborne'</span>, <span class="st">'milk'</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'catsize'</span>, <span class="st">'eggs'</span>, <span class="st">'milk'</span>, <span class="st">'airborne'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Z</span>, order <span class="op">=</span> <span class="st">'hclust'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/corrRect.html">corrRect</a></span><span class="op">(</span>namesMat <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/rectangles-3.png" width="600px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="change-color-spectra-color-legend-and-text-legend">Change color spectra, color-legend and text-legend<a class="anchor" aria-label="anchor" href="#change-color-spectra-color-legend-and-text-legend"></a>
</h2>
<p>We can get sequential and diverging colors from <code><a href="../reference/col1.html">COL1()</a></code>
and <code><a href="../reference/col2.html">COL2()</a></code>. The color palettes are borrowed from
<code>RColorBrewer</code> package.</p>
<p><strong>Notice</strong>: the middle color getting from
<code><a href="../reference/col2.html">COL2()</a></code> is fixed to <code>'#FFFFFF'</code>(white), thus we
can visualizing element 0 with white color.</p>
<ul>
<li>
<code><a href="../reference/col1.html">COL1()</a></code>: Get sequential colors, suitable for visualize a
non-negative or non-positive matrix (e.g. matrix in [0, 20], or [-100,
-10], or [100, 500]).</li>
<li>
<code><a href="../reference/col2.html">COL2()</a></code>: Get diverging colors, suitable for visualize a
matrix which elements are partly positive and partly negative
(e.g. correlation matrix in [-1, 1], or [-20, 100]).</li>
</ul>
<p>The colors of the correlation plots can be customized by
<code>col</code> in <code><a href="../reference/corrplot.html">corrplot()</a></code>. They are distributed
uniformly in <code>col.lim</code> interval.</p>
<ul>
<li>
<code>col</code>: vector, the colors of glyphs. They are distributed
uniformly in <code>col.lim</code> interval. By default,
<ul>
<li>If <code>is.corr</code> is <code>TRUE</code>, <code>col</code> will
be <code>COL2('RdBu', 200)</code>.</li>
<li>If <code>is.corr</code> is <code>FALSE</code>,
<ul>
<li>and <code>corr</code> is a non-negative or non-positive matrix,
<code>col</code> will be <code>COL1('YlOrBr', 200)</code>;</li>
<li>otherwise (elements are partly positive and partly negative),
<code>col</code> will be <code>COL2('RdBu', 200)</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<code>col.lim</code>: the limits (x1, x2) interval for assigning
color by <code>col</code>. By default,
<ul>
<li>
<code>col.lim</code> will be <code>c(-1, 1)</code> when
<code>is.corr</code> is <code>TRUE</code>,</li>
<li>
<code>col.lim</code> will be <code>c(min(corr), max(corr))</code>
when <code>is.corr</code> is <code>FALSE</code>.</li>
<li>
<strong>NOTICE</strong>: if you set <code>col.lim</code> when
<code>is.corr</code> is <code>TRUE</code>, the assigning colors are
still distributed uniformly in [-1, 1], it only affect the display on
color-legend.</li>
</ul>
</li>
<li>
<code>is.corr</code>: logical, whether the input matrix is a
correlation matrix or not. The default value is <code>TRUE</code>. We
can visualize a non-correlation matrix by setting
<code>is.corr = FALSE</code>.</li>
</ul>
<p>Here all diverging colors from <code><a href="../reference/col2.html">COL2()</a></code> and sequential
colors from <code><a href="../reference/col1.html">COL1()</a></code> are shown below.</p>
<p><strong>Diverging colors</strong>:</p>
<p><img src="webimg/unnamed-chunk-1-1.png" width="700px" style="display: block; margin: auto;"></p>
<p><strong>Sequential colors</strong>:</p>
<p><img src="webimg/unnamed-chunk-2-1.png" width="700px" style="display: block; margin: auto;"></p>
<p>Usage of <code><a href="../reference/col1.html">COL1()</a></code> and <code><a href="../reference/col2.html">COL2()</a></code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/col1.html">COL1</a></span><span class="op">(</span>sequential <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Oranges"</span>, <span class="st">"Purples"</span>, <span class="st">"Reds"</span>, <span class="st">"Blues"</span>, <span class="st">"Greens"</span>, </span>
<span>                    <span class="st">"Greys"</span>, <span class="st">"OrRd"</span>, <span class="st">"YlOrRd"</span>, <span class="st">"YlOrBr"</span>, <span class="st">"YlGn"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/col2.html">COL2</a></span><span class="op">(</span>diverging <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RdBu"</span>, <span class="st">"BrBG"</span>, <span class="st">"PiYG"</span>, <span class="st">"PRGn"</span>, <span class="st">"PuOr"</span>, <span class="st">"RdYlBu"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p>In addition, function <code><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette()</a></code> is very
convenient for generating color spectrum.</p>
<p>Parameters group <code>cl.*</code> is for color-legend. The
common-using are:</p>
<ul>
<li>
<code>cl.pos</code> is for the position of color labels. It is
character or logical. If character, it must be one of <code>'r'</code>
(means right, default if <code>type='upper'</code> or
<code>'full'</code>), <code>'b'</code> (means bottom, default if
<code>type='lower'</code>) or <code>'n'</code>(means don’t draw
color-label).</li>
<li>
<code>cl.ratio</code> is to justify the width of color-legend,
0.1~0.2 is suggested.</li>
</ul>
<p>Parameters group <code>tl.*</code> is for text-legend. The
common-using are:</p>
<ul>
<li>
<code>tl.pos</code> is for the position of text labels. It is
character or logical. If character, it must be one of <code>'lt'</code>,
<code>'ld'</code>, <code>'td'</code>, <code>'d'</code>, <code>'l'</code>
or <code>'n'</code>. <code>'lt'</code>(default if
<code>type='full'</code>) means left and top, <code>'ld'</code>(default
if <code>type='lower'</code>) means left and diagonal,
<code>'td'</code>(default if <code>type='upper'</code>) means top and
diagonal(near), <code>'d'</code> means diagonal, <code>'l'</code> means
left, <code>'n'</code> means don’t add text-label.</li>
<li>
<code>tl.cex</code> is for the size of text label (variable
names).</li>
<li>
<code>tl.srt</code> is for text label string rotation in
degrees.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, order <span class="op">=</span> <span class="st">'AOE'</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/col2.html">COL2</a></span><span class="op">(</span><span class="st">'RdBu'</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/color-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, order <span class="op">=</span> <span class="st">'AOE'</span>, addCoef.col <span class="op">=</span> <span class="st">'black'</span>, tl.pos <span class="op">=</span> <span class="st">'d'</span>,</span>
<span>         cl.pos <span class="op">=</span> <span class="st">'n'</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/col2.html">COL2</a></span><span class="op">(</span><span class="st">'PiYG'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/color-2.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, method <span class="op">=</span> <span class="st">'square'</span>, order <span class="op">=</span> <span class="st">'AOE'</span>, addCoef.col <span class="op">=</span> <span class="st">'black'</span>, tl.pos <span class="op">=</span> <span class="st">'d'</span>,</span>
<span>         cl.pos <span class="op">=</span> <span class="st">'n'</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/col2.html">COL2</a></span><span class="op">(</span><span class="st">'BrBG'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/color-3.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## bottom color legend, diagonal text legend, rotate text label</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, order <span class="op">=</span> <span class="st">'AOE'</span>, cl.pos <span class="op">=</span> <span class="st">'b'</span>, tl.pos <span class="op">=</span> <span class="st">'d'</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="../reference/col2.html">COL2</a></span><span class="op">(</span><span class="st">'PRGn'</span><span class="op">)</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/color-4.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## text labels rotated 45 degrees and  wider color legend with numbers right aligned</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, type <span class="op">=</span> <span class="st">'lower'</span>, order <span class="op">=</span> <span class="st">'hclust'</span>, tl.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>         cl.ratio <span class="op">=</span> <span class="fl">0.2</span>, tl.srt <span class="op">=</span> <span class="fl">45</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/col2.html">COL2</a></span><span class="op">(</span><span class="st">'PuOr'</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/color-5.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## remove color legend, text legend and principal diagonal glyph</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, order <span class="op">=</span> <span class="st">'AOE'</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span>, tl.pos <span class="op">=</span> <span class="st">'n'</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="st">'black'</span><span class="op">)</span>, bg <span class="op">=</span> <span class="st">'gold2'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/color-6.png" width="600px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="visualize-non-correlation-matrix-na-value-and-math-label">Visualize non-correlation matrix, NA value and math label<a class="anchor" aria-label="anchor" href="#visualize-non-correlation-matrix-na-value-and-math-label"></a>
</h2>
<p>We can visualize a non-correlation matrix by set
<code>is.corr=FALSE</code>, and assign colors by <code>col.lim</code>.
If the matrix have both positive and negative values, the matrix
transformation keep every values positiveness and negativeness.</p>
<p>If your matrix is rectangular, you can adjust the aspect ratio with
the <code>win.asp</code> parameter to make the matrix rendered as a
square.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## matrix in [20, 26], grid.col</span></span>
<span><span class="va">N1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">20</span>, <span class="fl">26</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">N1</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">'color'</span>, tl.pos <span class="op">=</span> <span class="st">'n'</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="../reference/col1.html">COL1</a></span><span class="op">(</span><span class="st">'YlGn'</span><span class="op">)</span>, cl.pos <span class="op">=</span> <span class="st">'b'</span>, addgrid.col <span class="op">=</span> <span class="st">'white'</span>, addCoef.col <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/non-corr-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## matrix in [-15, 10]</span></span>
<span><span class="va">N2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">15</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## using sequential colors, transKeepSign = FALSE</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">N2</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span>, transKeepSign <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">'color'</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">10</span><span class="op">)</span>, </span>
<span>         tl.pos <span class="op">=</span> <span class="st">'n'</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/col1.html">COL1</a></span><span class="op">(</span><span class="st">'YlGn'</span><span class="op">)</span>, cl.pos <span class="op">=</span> <span class="st">'b'</span>, addCoef.col <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in title(title, ...): "transKeepSign" is not a graphical parameter</span></span></code></pre>
<p><img src="webimg/non-corr-2.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## using diverging colors, transKeepSign = TRUE (default)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">N2</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">10</span><span class="op">)</span>, </span>
<span>         tl.pos <span class="op">=</span> <span class="st">'n'</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/col2.html">COL2</a></span><span class="op">(</span><span class="st">'PiYG'</span><span class="op">)</span>, cl.pos <span class="op">=</span> <span class="st">'b'</span>, addCoef.col <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/non-corr-3.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## using diverging colors</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">N2</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">'color'</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">10</span><span class="op">)</span>, tl.pos <span class="op">=</span> <span class="st">'n'</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="../reference/col2.html">COL2</a></span><span class="op">(</span><span class="st">'PiYG'</span><span class="op">)</span>, cl.pos <span class="op">=</span> <span class="st">'b'</span>, addCoef.col <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/non-corr-4.png" width="600px" style="display: block; margin: auto;"></p>
<p>Notice: when <code>is.corr</code> is <code>TRUE</code>,
<code>col.lim</code> only affect the color legend If you change it, the
color on correlation matrix plot is still assigned on
<code>c(-1, 1)</code></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># when is.corr=TRUE, col.lim only affect the color legend display</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/col-lim-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span><span class="op">/</span><span class="fl">2</span>, col.lim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/col-lim-2.png" width="600px" style="display: block; margin: auto;"></p>
<p>By default, <strong>corrplot</strong> renders NA values as
<code>'?'</code> characters. Using <code>na.label</code> parameter, it
is possible to use a different value (max. two characters are
supported).</p>
<p>Since version <code>0.78</code>, it is possible to use <a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath" class="external-link">plotmath</a>
expression in variable names. To activate plotmath rendering, prefix
your label with <code>'$'</code>.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M2</span> <span class="op">=</span> <span class="va">M</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">M2</span><span class="op">)</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">M2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'$alpha+beta'</span>, <span class="st">'$alpha[0]'</span>, <span class="st">'$alpha[beta]'</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">M2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'$Sigma[i]^n'</span>, <span class="st">'$sigma'</span>,  <span class="st">'$alpha[0]^100'</span>, <span class="st">'$alpha[beta]'</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">M2</span><span class="op">)</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, tl.cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/NA-math-1.png" width="600px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="visualize-p-value-and-confidence-interval">Visualize p-value and confidence interval<a class="anchor" aria-label="anchor" href="#visualize-p-value-and-confidence-interval"></a>
</h2>
<p><code><a href="../reference/corrplot.html">corrplot()</a></code> can also visualize p-value and confidence
interval on the correlation matrix plot. Here are some important
parameters.</p>
<p>About p-value:</p>
<ul>
<li>
<code>p.mat</code> is the p-value matrix, if <code>NULL</code>,
parameter <code>sig.level</code>, <code>insig, pch</code>,
<code>pch.col</code>, <code>pch.cex</code> are invalid.</li>
<li>
<code>sig.level</code> is significant level, with default value
0.05. If the p-value in <code>p-mat</code> is bigger than
<code>sig.level</code>, then the corresponding correlation coefficient
is regarded as insignificant. If <code>insig</code> is
<code>'label_sig'</code>, <code>sig.level</code> can be an increasing
vector of significance levels, in which case <code>pch</code> will be
used once for the highest p-value interval and multiple times
(e.g. <code>'*'</code>, <code>'**'</code>, <code>'***'</code>) for each
lower p-value interval.</li>
<li>
<code>insig</code> Character, specialized insignificant correlation
coefficients, <code>'pch'</code> (default), <code>'p-value'</code>,
<code>'blank',</code> <code>'n'</code>, or <code>'label_sig'</code>. If
<code>'blank'</code>, wipe away the corresponding glyphs; if
<code>'p-value'</code>, add p-values the corresponding glyphs; if
<code>'pch'</code>, add characters (see pch for details) on
corresponding glyphs; if <code>'n'</code>, don’t take any measures; if
<code>'label_sig'</code>, mark significant correlations with
<code>pch</code> (see <code>sig.level</code>).</li>
<li>
<code>pch</code> is for adding character on the glyphs of
insignificant correlation coefficients (only valid when insig is
<code>'pch'</code>). See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">?par</a></code> .</li>
</ul>
<p>About confidence interval:</p>
<ul>
<li>
<code>plotCI</code> is character for the method of plotting
confidence interval. If <code>'n'</code>, don’t plot confidence
interval. If <code>'rect'</code>, plot rectangles whose upper side means
upper bound and lower side means lower bound respectively.</li>
<li>
<code>lowCI.mat</code> is the matrix of the lower bound of
confidence interval.</li>
<li>
<code>uppCI.mat</code> is the Matrix of the upper bound of
confidence interval.</li>
</ul>
<p>We can get p-value matrix and confidence intervals matrix by
<code><a href="../reference/cor.mtest.html">cor.mtest()</a></code> which returns a list containing:</p>
<ul>
<li>
<code>p</code> is the p-values matrix.</li>
<li>
<code>lowCI</code> is the lower bound of confidence interval
matrix.</li>
<li>
<code>uppCI</code> is the lower bound of confidence interval
matrix.</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testRes</span> <span class="op">=</span> <span class="fu"><a href="../reference/cor.mtest.html">cor.mtest</a></span><span class="op">(</span><span class="va">mtcars</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## specialized the insignificant value according to the significant level</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, p.mat <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">p</span>, sig.level <span class="op">=</span> <span class="fl">0.10</span>, order <span class="op">=</span> <span class="st">'hclust'</span>, addrect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/test-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## leave blank on non-significant coefficient</span></span>
<span><span class="co">## add significant correlation coefficients</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, p.mat <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">p</span>, method <span class="op">=</span> <span class="st">'circle'</span>, type <span class="op">=</span> <span class="st">'lower'</span>, insig<span class="op">=</span><span class="st">'blank'</span>,</span>
<span>         addCoef.col <span class="op">=</span><span class="st">'black'</span>, number.cex <span class="op">=</span> <span class="fl">0.8</span>, order <span class="op">=</span> <span class="st">'AOE'</span>, diag<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/test-2.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## leave blank on non-significant coefficient</span></span>
<span><span class="co">## add all correlation coefficients</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, p.mat <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">p</span>, method <span class="op">=</span> <span class="st">'circle'</span>, type <span class="op">=</span> <span class="st">'lower'</span>, insig<span class="op">=</span><span class="st">'blank'</span>,</span>
<span>         order <span class="op">=</span> <span class="st">'AOE'</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">corrPos</span> <span class="op">-&gt;</span> <span class="va">p1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">x</span>, <span class="va">p1</span><span class="op">$</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">corr</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/special-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## add p-values on no significant coefficients</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, p.mat <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">p</span>, insig <span class="op">=</span> <span class="st">'p-value'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/p-values-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## add all p-values</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, p.mat <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">p</span>, insig <span class="op">=</span> <span class="st">'p-value'</span>, sig.level <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/p-values-2.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## add significant level stars</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, p.mat <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">p</span>, method <span class="op">=</span> <span class="st">'color'</span>, diag <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="st">'upper'</span>,</span>
<span>         sig.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>, pch.cex <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         insig <span class="op">=</span> <span class="st">'label_sig'</span>, pch.col <span class="op">=</span> <span class="st">'grey20'</span>, order <span class="op">=</span> <span class="st">'AOE'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/p-values-3.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## add significant level stars and cluster rectangles</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, p.mat <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">p</span>, tl.pos <span class="op">=</span> <span class="st">'d'</span>, order <span class="op">=</span> <span class="st">'hclust'</span>, addrect <span class="op">=</span> <span class="fl">2</span>,</span>
<span>         insig <span class="op">=</span> <span class="st">'label_sig'</span>, sig.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>         pch.cex <span class="op">=</span> <span class="fl">0.9</span>, pch.col <span class="op">=</span> <span class="st">'grey20'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/p-values-4.png" width="600px" style="display: block; margin: auto;"></p>
<p>Visualize confidence interval.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize confidence interval</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, lowCI <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">lowCI</span>, uppCI <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">uppCI</span>, order <span class="op">=</span> <span class="st">'hclust'</span>,</span>
<span>         tl.pos <span class="op">=</span> <span class="st">'d'</span>, rect.col <span class="op">=</span> <span class="st">'navy'</span>, plotC <span class="op">=</span> <span class="st">'rect'</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/confidence-interval-1.png" width="600px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize confidence interval and cross the significant coefficients</span></span>
<span><span class="fu"><a href="../reference/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">M</span>, p.mat <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">p</span>, lowCI <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">lowCI</span>, uppCI <span class="op">=</span> <span class="va">testRes</span><span class="op">$</span><span class="va">uppCI</span>,</span>
<span>         addrect <span class="op">=</span> <span class="fl">3</span>, rect.col <span class="op">=</span> <span class="st">'navy'</span>, plotC <span class="op">=</span> <span class="st">'rect'</span>, cl.pos <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<p><img src="webimg/confidence-interval-2.png" width="600px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Michael Friendly (2002). Corrgrams: Exploratory displays for
correlation matrices. The American Statistician, 56, 316–324.</p></li>
<li><p>D.J. Murdoch, E.D. Chow (1996). A graphical display of large
correlation matrices. The American Statistician, 50, 178–180.</p></li>
<li><p>Michael Hahsler, Christian Buchta and Kurt Hornik (2020).
seriation: Infrastructure for Ordering Objects Using Seriation. R
package version 1.2-9. <a href="https://CRAN.R-project.org/package=seriation" class="external-link uri">https://CRAN.R-project.org/package=seriation</a></p></li>
<li><p>Hahsler M, Hornik K, Buchta C (2008). “Getting things in order:
An introduction to the R package seriation.” <em>Journal of Statistical
Software</em>, <em>25</em>(3), 1-34. ISSN 1548-7660, doi:
10.18637/jss.v025.i03 (URL: <a href="https://doi.org/10.18637/jss.v025.i03" class="external-link uri">https://doi.org/10.18637/jss.v025.i03</a>), &lt;URL: <a href="https://www.jstatsoft.org/v25/i03/" class="external-link uri">https://www.jstatsoft.org/v25/i03/</a>&gt;.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Taiyun Wei, Viliam Simko.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
